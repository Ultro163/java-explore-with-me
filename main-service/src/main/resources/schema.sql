DROP TABLE IF EXISTS events;
DROP TABLE IF EXISTS users;
DROP TABLE IF EXISTS categories;
DROP TABLE IF EXISTS locations;


CREATE TABLE IF NOT EXISTS users
(
    id    bigint generated by default as identity,
    name  varchar        not null,
    email varchar unique not null,
    CONSTRAINT users_pk PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS categories
(
    id   bigint generated by default as identity,
    name varchar not null,
    CONSTRAINT categories_pk primary key (id)
);

CREATE table if not exists locations
(
    id  bigint generated by default as identity,
    lat float,
    lon float,
    CONSTRAINT locations_pk primary key (id)
);

CREATE TABLE IF NOT EXISTS events
(
    id                 bigint generated by default as identity,
    annotation         varchar                     not null,
    category_id        bigint                      not null,
    confirmed_request  integer,
    created_on         timestamp without time zone,
    description        varchar,
    event_date         timestamp without time zone not null,
    initiator_id       bigint                      not null,
    location_id        bigint                      not null,
    paid               boolean                     not null,
    participantLimit   integer,
    published_on       timestamp without time zone,
    request_moderation boolean,
    state              varchar,
    title              varchar                     not null,
    CONSTRAINT events_pk primary key (id),
    CONSTRAINT events_initiator_fk foreign key (initiator_id) REFERENCES users (id),
    CONSTRAINT events_location_fk foreign key (location_id) REFERENCES locations (id),
    CONSTRAINT events_category_fk foreign key (category_id) REFERENCES categories (id)
);